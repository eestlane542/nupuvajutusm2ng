<!DOCTYPE html>
<html lang="et">
<head>
<meta charset="UTF-8">
<title>Pommide mäng</title>
<style>
  body { margin:0; background:#000; color:#fff; font-family:sans-serif; text-align:center; }
  canvas { background:#111; display:block; margin:10px auto; }
</style>
</head>
<body>

<h2>Punktid: <span id="score">0</span></h2>
<p>Vajuta 1 / 2 / 3 (100, 200, 300 punkti)</p>
<canvas id="c" width="800" height="400"></canvas>

<script>
const c = document.getElementById("c");
const ctx = c.getContext("2d");
const scoreEl = document.getElementById("score");

let score = 0;
let collisionsOn = false;

const bombs = [];
const COUNT = 50; // pommide arv

for (let i = 0; i < COUNT; i++) {
  bombs.push({
    x: Math.random() * c.width,
    y: Math.random() * c.height,
    vx: (Math.random() - 0.5) * 4,
    vy: (Math.random() - 0.5) * 4,
    r: 8
  });
}

// Põrge pommide vahel
function collide() {
  for (let i = 0; i < bombs.length; i++) {
    for (let j = i + 1; j < bombs.length; j++) {
      const dx = bombs[i].x - bombs[j].x;
      const dy = bombs[i].y - bombs[j].y;
      const d = Math.hypot(dx, dy);

      if (d < bombs[i].r + bombs[j].r) {
        bombs[i].vx *= -1;
        bombs[i].vy *= -1;
        bombs[j].vx *= -1;
        bombs[j].vy *= -1;
      }
    }
  }
}

// Mängu loop
function loop() {
  ctx.clearRect(0,0,c.width,c.height);

  bombs.forEach(b => {
    b.x += b.vx;
    b.y += b.vy;

    if (b.x < b.r || b.x > c.width - b.r) b.vx *= -1;
    if (b.y < b.r || b.y > c.height - b.r) b.vy *= -1;

    ctx.beginPath();
    ctx.arc(b.x,b.y,b.r,0,Math.PI*2);
    ctx.fillStyle = "red";
    ctx.fill();
  });

  if (collisionsOn) collide();

  requestAnimationFrame(loop);
}

loop();

// Punktide lisamine 1/2/3 klahvidega
document.addEventListener("keydown", e => {
  if (e.key === "1") score += 100;
  if (e.key === "2") score += 200;
  if (e.key === "3") score += 300;

  scoreEl.textContent = score;

  if (score >= 300) {
    collisionsOn = true;
  }
});
</script>

</body>
</html>
